Cluster balancing algorithmCloudera Docs
Cluster balancing
      algorithm
The HDFS Balancer runs in iterations. Each iteration contains the following four
      steps: storage group classification, storage group pairing, block move scheduling, and block
      move execution.
Storage group classificationThe HDFS Balancer first invokes the getLiveDatanodeStorageReport         rpc to the Namenode to the storage report for all the storages in all Datanodes. The storage         report contains storage utilization information such as capacity, dfs used space, remaining         space, and so forth, for each storage in each DataNode.Storage group pairingThe HDFS Balancer selects over-utilized or above-average storage as source storage,       and under-utilized or below-average storage as target storage. It pairs a source storage group       with a target storage group (source â†’ target) in a priority order depending on whether or not       the source and the target storage reside in the same rack.Block move schedulingFor each source-target pair, the HDFS Balancer chooses block replicas from the source       storage groups and schedules block moves.Block move executionThe HDFS Balancer dispatches a scheduled block move by invoking the             DataTransferProtocol.replaceBlock(..) method to the target DataNode. Parent topic: Balancing data across an HDFS cluster