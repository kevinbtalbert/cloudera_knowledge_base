DAS administration using Ambari in CDPCloudera Docs
DAS administration using Ambari in CDP
The topics listed in this section describe how you can run a query on a different Hive
    instance, clean up DAG data from the Postgres database, create system tables to run queries on
    DAG events, and change the retention period of DAS event logs in a CDP Private Cloud Base
    cluster that is managed using Ambari.
This section applies only if you have installed DAS on a CDP Private Cloud Base cluster using
      Ambari.

Running a query on a different Hive instanceBy default, ZooKeeper redirects your query to run on a Hive instance that is         available at that time. However, if you have optimized a certain Hive instance, and you want         to run your workload on that particular Hive instance, then you can switch to that instance         by specifying the HiveServer2 host name and the port in the JDBC connection field on the DAS         user interface.Cleaning up old queries, DAG information, and reports data using AmbariThe DAS Postgres database stores all the queries that you run from the DAS UI or         beeline, and all the data that is used to generate the DAG information and reports. Over a         period of time, this can grow in size. To optimize the available capacity, DAS has a cleanup         mechanism that, by default, purges all the queries and DAG information older than 30 days         and purges old reports after 365 days. However, you can customize the cleanup frequency by         adding the cleanup.query-info.interval, and             cleanup.report-info.interval configurations, and the Cron expression:             cleanup.cron.expression in the             das-event-processor.json file from Ambari.Creating system tables to run query on Hive and Tez DAG eventsThe Tez DAG events are exposed in the dag_data table, and the Hive query events are         exposed in the query_data table in the sys database. You can run Hive queries from DAS to         process these events and generate custom reports.Changing the retention period of DAS event logsIf you click on a task on the DAG swimlane for a query for which the event logs were         cleaned up, you see the “DAG info not available” message on the task         attempt page. You can increase the retention period to resolve this issue.