Preparing the services for upgradeCloudera Docs
Preparing the services for upgrade
You must complete the pre-upgrade steps for the components and services that you are
  going to upgrade.
Backing up Ambari infra dataIn Ambari 7.1.x.x, Ambari Infra Solr uses Solr 8. For data stored in the existing         Solr 5 implementation used by Ambari 2.6.2.x, the data stored in Ambari Infra must be backed         up and the Ambari Infra Solr services must be upgraded. Overview of the Migration of the Atlas and Infra Solr DataThe illustration helps you to understand the overview of the upgrade of the the Atlas   and Infra Solr services' data from HDP to CDP Private Cloud Base.Ranger Service connection with Oracle databaseIf you have configured Ranger with Oracle Database as its backend, you must add the         property with Key and Value.Ranger admin passwordDuring the HDP upgrade, Ranger admin fails to apply the Java patch to change all         admin passwords if the             hadoop.security.credstore.java-keystore-provider.password-file         property is set in core-site.Preparing HBase for upgradeBefore upgrading to CDP Private Cloud Base, transition your         HFiles to a supported encoding type and validate HFiles to ensure that you do not have any         HFiles that use unsupported encoding or are in a bad state.Preparing HDP Search for upgradeCloudera provides the solr-upgrade.sh script to transition HDP Search     2 or 3 configurations to make them compatible with Solr 8 that is shipped with Cloudera Runtime 7.1.1     or higher. To run this     script, you need to download configuration metadata from your HDP Search instance and copy it to     an interim CDP cluster with Solr service. You can then use that same cluster to validate and     test the migrated configuration metadata. Preparing Hive for upgradeHive needs house cleaning before an upgrade. Some house cleaning tasks are mandatory to     prevent upgrade failure. A smooth upgrade experience justifies spending the time and effort to     clean up problems. Some problems prevent conversion of old Hive tables to Hive 3 ACID tables. Preparing Kafka for upgradeTo successfully upgrade Kafka, you must set the protocol version to match the protocol   version used by the brokers and clients. Preparing Zeppelin for upgradeBefore upgrading HDP to CDP, you must copy the Zeppelin notebooks     and configuration files from HDFS to the Zeppelin server host     filesystem.Additional backupsTake a backup of backups and ensure it is functional. This is an example script to         take a backup of backups. Parent topic: Upgrading HDP to Cloudera Runtime 7.1.x