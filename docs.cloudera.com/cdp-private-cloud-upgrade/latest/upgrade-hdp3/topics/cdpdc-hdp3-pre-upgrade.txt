Pre-upgrade stepsCloudera Docs
Pre-upgrade steps
You must complete the pre-upgrade steps for the components and services that you are
  going to upgrade.
Ranger Service connection with Oracle databaseIf you have configured Ranger with Oracle Database as its backend, you must add the         property with Key and Value.Ranger admin passwordDuring the HDP upgrade, Ranger admin fails to apply the Java patch to change all         admin passwords if the         hadoop.security.credstore.java-keystore-provider.password-file         property is set in core-site.Preparing Spark for upgradeYou must migrate catalog data from dual catalog mode to single catalog mode before you upgrade HDP 3.1.5.x to HDP intermediate bits.Backing up Ambari infra Solr dataIn Ambari 7.1.x.x, Ambari Infra Solr uses Solr 8.4.1. For data stored in the existing         Solr 5 implementation used by Ambari 2.6.2.x, the data stored in Ambari Infra must be backed         up and the Ambari Infra Solr services must be upgraded. Preparing HBase for upgradeYou must remove the HBase backup-and-restore-utility configuration present in your         HDP 3.1.5 cluster before you migrate to CDP. CDP Private Cloud Base does not support the         backup-and-restore utility present in HDP 3.1.5.Turn off YARN GPUIf YARN GPU is enabled on your HDP cluster, then you must turn off the YARN GPU         feature on the HDP cluster and enable it on the CDP cluster.Preparing HDP Search for upgradeCloudera provides the solr-upgrade.sh script to transition HDP Search     2 or 3 configurations to make them compatible with Solr 8 that is shipped with Cloudera Runtime 7.1.1     or higher. To run this     script, you need to download configuration metadata from your HDP Search instance and copy it to     an interim CDP cluster with Solr service. You can then use that same cluster to validate and     test the migrated configuration metadata. Preparing ZooKeeper for upgradePreparing Kafka for upgradeTo successfully upgrade Kafka, you must set the protocol version to match the protocol   version used by the brokers and clients. Parent topic: Upgrading HDP to Cloudera Runtime 7.1.x